<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>æ•°æ®æœåŠ¡ DataService</title>
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="../../common/inner.css" />
    <script src="../../common/js/inner.js"></script>
</head>

<body>
    <h1>ğŸ”§ å®‰è£…</h1>
    <section>
        <a name="install"></a>
        <h2>å®‰è£…</h2>

        <h3>åˆå§‹åŒ–æ•°æ®</h3>
        <p>æ•°æ®æœåŠ¡ä¾èµ–ä¸¤å¼ è¡¨ <span class="c">ds_common_api</span> å’Œ <span class="c">ds_project</span> ä½œä¸ºé…ç½®æ•°æ®è¡¨ã€‚åœ¨ä½ çš„æ•°æ®åº“ä¸­æ‰§è¡Œåˆ›å»ºè¡¨çš„
            DDLï¼Œæˆ–è€…æ‰§è¡Œ <a
                href="https://github.com/lightweight-component/aj-data/blob/main/src/main/sql/init-dataservice.sql"
                target="_blank">init-dataservice.sql</a> DDLã€‚</p>
        <pre class="code sql-ddl-code">CREATE TABLE `ds_common_api` (
    `id` INT(10) NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”® idï¼Œè‡ªå¢',
    `pid` INT(10) NULL DEFAULT '-1' COMMENT 'çˆ¶èŠ‚ç‚¹ idï¼Œå¦‚æœæ˜¯é¡¶çº§èŠ‚ç‚¹ä¸º -1 æˆ–è€…ç©º',
    `name` VARCHAR(90) NULL DEFAULT NULL COMMENT 'è¯´æ˜',
    `namespace` VARCHAR(50) NOT NULL COMMENT 'å‘½åç©ºé—´ï¼Œæ ‡è¯†',
    `table_name` VARCHAR(45) NULL DEFAULT NULL COMMENT 'è¡¨å',
    `type` VARCHAR(10) NULL DEFAULT NULL COMMENT 'ç±»å‹ SINGLE | CRUD',
    `clz_name` VARCHAR(10) NULL DEFAULT NULL COMMENT 'å®ä½“ç±»å¼•ç”¨åç§°',
    `id_field` VARCHAR(10) NULL DEFAULT 'id' COMMENT 'ä¸»é”®å­—æ®µåç§°',
    `sql` TEXT NULL DEFAULT NULL COMMENT 'å•æ¡ SQL å‘½ä»¤',
    `info_sql` TEXT NULL DEFAULT NULL COMMENT 'æŸ¥è¯¢è¯¦æƒ…çš„ SQLï¼ˆå¯é€‰çš„ï¼‰',
    `list_sql` TEXT NULL DEFAULT NULL COMMENT 'æŸ¥è¯¢åˆ—è¡¨çš„ SQLï¼ˆå¯é€‰çš„ï¼‰',
    `create_sql` TEXT NULL DEFAULT NULL COMMENT 'åˆ›å»ºçš„ SQLï¼ˆå¯é€‰çš„ï¼‰',
    `update_sql` TEXT NULL DEFAULT NULL COMMENT 'ä¿®æ”¹çš„ SQLï¼ˆå¯é€‰çš„ï¼‰',
    `delete_sql` TEXT NULL DEFAULT NULL COMMENT 'åˆ é™¤çš„ SQLï¼ˆå¯é€‰çš„ï¼‰',
    `del_field` VARCHAR(100) NULL DEFAULT 'stat' COMMENT 'åˆ é™¤å­—æ®µåç§°',
    `has_is_deleted` TINYINT(1) NULL DEFAULT '1' COMMENT 'æ˜¯å¦æœ‰é€»è¾‘åˆ é™¤æ ‡è®°',
    `tenant_isolation` TINYINT(3) UNSIGNED NULL DEFAULT NULL COMMENT 'æ˜¯å¦åŠ å…¥ç§Ÿæˆ·æ•°æ®éš”ç¦»',
    `id_type` TINYINT(3) UNSIGNED NULL DEFAULT NULL COMMENT '1=è‡ªå¢ï¼›2=é›ªèŠ±ï¼›3=UUID',
    `stat` TINYINT(3) UNSIGNED NULL DEFAULT '0' COMMENT 'æ•°æ®å­—å…¸ï¼šçŠ¶æ€',
    `creator` VARCHAR(50) NULL DEFAULT NULL COMMENT 'åˆ›å»ºäººåç§°ï¼ˆå¯å†—ä½™çš„ï¼‰' ,
    `creator_id` INT(10) NULL DEFAULT NULL COMMENT 'åˆ›å»ºäºº id',
    `create_date` DATETIME NOT NULL DEFAULT (now()) COMMENT 'åˆ›å»ºæ—¥æœŸ',
    `updater` VARCHAR(50) NULL DEFAULT NULL COMMENT 'ä¿®æ”¹äººåç§°ï¼ˆå¯å†—ä½™çš„ï¼‰',
    `updater_id` INT(10) NULL DEFAULT NULL COMMENT 'ä¿®æ”¹äºº id',
    `update_date` DATETIME NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP COMMENT 'ä¿®æ”¹æ—¥æœŸ',
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE INDEX `id_UNIQUE` (`id`) USING BTREE
)
COMMENT='é€šç”¨ä¸‡èƒ½å‹ API æ¥å£çš„é…ç½®'
COLLATE='utf8mb4_unicode_ci'</pre>


        <pre class="code sql-ddl-code">CREATE TABLE `ds_project` (
    `id` INT(10) NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”® idï¼Œè‡ªå¢',
    `datasource_id` INT(10) NULL DEFAULT NULL COMMENT 'æ•°æ®æº id',
    `name` VARCHAR(90) NULL DEFAULT NULL COMMENT 'è¯´æ˜',
    `api_prefix_dev` VARCHAR(100) NULL DEFAULT NULL COMMENT 'API å‰ç¼€ï¼ˆå¼€å‘é˜¶æ®µï¼‰',
    `api_prefix_prod` VARCHAR(100) NULL DEFAULT NULL COMMENT 'API å‰ç¼€ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰',
    `default_config` JSON NULL DEFAULT NULL COMMENT 'é»˜è®¤é…ç½®',
    `stat` TINYINT(3) UNSIGNED NULL DEFAULT '0' COMMENT 'æ•°æ®å­—å…¸ï¼šçŠ¶æ€',
    `creator` VARCHAR(50) NULL DEFAULT NULL COMMENT 'åˆ›å»ºäººåç§°ï¼ˆå¯å†—ä½™çš„ï¼‰',
    `creator_id` INT(10) NULL DEFAULT NULL COMMENT 'åˆ›å»ºäºº id',
    `create_date` DATETIME NOT NULL DEFAULT (now()) COMMENT 'åˆ›å»ºæ—¥æœŸ',
    `updater` VARCHAR(50) NULL DEFAULT NULL COMMENT 'ä¿®æ”¹äººåç§°ï¼ˆå¯å†—ä½™çš„ï¼‰',
    `updater_id` INT(10) NULL DEFAULT NULL COMMENT 'ä¿®æ”¹äºº id',
    `update_date` DATETIME NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP COMMENT 'ä¿®æ”¹æ—¥æœŸ',
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE INDEX `id_UNIQUE` (`id`) USING BTREE
)
COMMENT='é¡¹ç›®'</pre>
        <p>æ’å…¥ä¸¤ç¬”æ–°çš„æ•°æ®ï¼Œè¯»å–é…ç½®ã€‚</p>
        <pre
            class="code sql-code">INSERT INTO `ds_common_api` (`id`, `pid`, `name`, `namespace`, `table_name`, `type`, `clz_name`, `id_field`, `sql`, 
`info_sql`, `list_sql`, `create_sql`, `update_sql`, `delete_sql`, `del_field`, `has_is_deleted`, `tenant_isolation`, `id_type`, `stat`) 
VALUES (1, -1, 'å·¥ç¨‹', 'project', 'ds_project', NULL, NULL, 'id', NULL, NULL, NULL, NULL, NULL, NULL, 'stat', 1, NULL, NULL, 0);

INSERT INTO `ds_common_api` (`id`, `pid`, `name`, `namespace`, `type`, `table_name`, `clz_name`, `id_field`, `sql`, 
`info_sql`, `list_sql`, `create_sql`, `update_sql`, `delete_sql`, `del_field`, `has_is_deleted`, `tenant_isolation`, `id_type`, `stat`) 
VALUES (5, -1, 'common_api', 'common_api', '', 'common_api', NULL, 'id', NULL, NULL, 'SELECT \r\n	(SELECT JSON_ARRAYAGG(JSON_OBJECT(\r\n                  
\'id\', id, \'pid\', pid, \'name\', name, \'namespace\', namespace, \'tableName\', table_name, \'idField\', id_field,\r\n                  
\'className\', clz_name, \'delField\', del_field, \'sql\', `sql`, \'infoSql\', info_sql, \'listSql\', list_sql, \'type\', type,\r\n                  
\'createSql\', create_sql, \'updateSql\', update_sql, \'deleteSql\', delete_sql, \'hasIsDeleted\',\r\n                   
CAST(has_is_deleted = 1 AS JSON), \'tenantIsolation\', tenant_isolation, \'idType\', id_type, \'stat\', stat, \'creator\', creator,\r\n                  
\'creatorId\', creator_id, \'createDate\', create_date, \'updater\', updater,\r\n                 
 \'updaterId\', updater_id, \'updateDate\', update_date\r\n	)) FROM ds_common_api WHERE stat != 1 AND pid = a.id) AS children,\r\n	
 a.*\r\n FROM ds_common_api a WHERE a.stat != 1 AND (pid IS NULL OR pid = -1)', NULL, NULL, NULL, 'stat', 1, NULL, NULL, 0);</pre>
    </section>

    <section>
        <a name="install"></a>
        <h2>å‰ç«¯ç®¡ç†é¡µé¢</h2>
    </section>
</body>

</html>